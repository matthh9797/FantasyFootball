liveHome_1719 <- group_by(liverpoolResult1719, HomeTeam, Period) %>% summarise(GoalScored = sum(FTHG), GoalAgainst = sum(FTAG))
liveHome_1719
liveHome_1719 <- group_by(liverpoolResult1719, Period) %>% summarise(GoalScored = sum(FTHG), GoalAgainst = sum(FTAG))
liveHome_1719
liveHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Liverpool")
livAway_1719 <- filter(liverpoolResult1719, AwayTeam == "Liverpool")
liveHome_1719 <- liveHome_1719 %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
livAway_1719 <- livAway_1719 %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
liveHome_1719
livHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Liverpool") %>% group_by(Period)
livAway_1719 <- filter(liverpoolResult1719, AwayTeam == "Liverpool") %>% group_by(Period)
livHome_1719 <- livHome_1719 %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
livAway_1719 <- livAway_1719 %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
liveHome_1719
livHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Liverpool") %>% group_by(Period)
liveHome_1719
livHome_1719
livHome_1719 <- livHome_1719 %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
livHome_1719
livAway_1719
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 2))
levels(seasonSections) <- c("Section 1", "Section 2", "Section 3")
liverpoolResult1719 <- filter(result_tbl, (HomeTeam == "Liverpool" | AwayTeam == "Liverpool") & Season %in% c("1718", "1819"))
liverpoolResult1719 <- mutate(liverpoolResult1719, Period = seasonSections)
livHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Liverpool") %>% group_by(Period)
livAway_1719 <- filter(liverpoolResult1719, AwayTeam == "Liverpool") %>% group_by(Period)
livHome_1719 <- livHome_1719 %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
livAway_1719 <- livAway_1719 %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
livHome_1719
livAway_1719
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 2))
levels(seasonSections) <- c("Section 1", "Section 2", "Section 3")
liverpoolResult1719 <- filter(result_tbl, (HomeTeam == "Man City" | AwayTeam == "Man City") & Season %in% c("1718", "1819"))
liverpoolResult1719 <- mutate(liverpoolResult1719, Period = seasonSections)
manCHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Man City") %>% group_by(Period)
manCAway_1719 <- filter(liverpoolResult1719, AwayTeam == "Man City") %>% group_by(Period)
manCHome_1719 <- manCHome_1719 %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
manCAway_1719 <- manCAway_1719 %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
manCHome_1719
manCAway_1719
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 2))
levels(seasonSections) <- c("Section 1", "Section 2", "Section 3")
liverpoolResult1719 <- filter(result_tbl, (HomeTeam == "Man City" | AwayTeam == "Man City") & Season %in% c("1718", "1819"))
liverpoolResult1719 <- mutate(liverpoolResult1719, Period = seasonSections)
manCHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Man City") %>% group_by(Period)
manCAway_1719 <- filter(liverpoolResult1719, AwayTeam == "Man City") %>% group_by(Period)
manCHome_1719 <- manCHome_1719 %>% summarise(HomeGoal=sum(FTHG), HomeConcede=sum(FTAG))
manCAway_1719 <- manCAway_1719 %>% summarise(AwayGoal=sum(FTAG), AwayConcede=sum(FTHG))
manC_cutSeason <- join(manCHome_1719, manCAway_1719)
manC_cutSeason <- merge(manCHome_1719, manCAway_1719)
manC_cutSeason
x <- c("a", "b", "c")
length(x)
source("data/cutSeason.R")
source("code/cutSeason.R")
cutSeason(result_tbl, "Man City", years = c("1718", "1819"))
city_1718 <- cutSeason(result_tbl, "Man City", years = c("1718", "1819"))
city_1718
print(cutSeason(result_tbl, "Chelsea", c("1718", "1819")))
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
source("code/cutSeason.R")
print(cutSeason(result_tbl, "Bournemouth", c("1718", "1819")))
print(cutSeason(result_tbl, "Bournemouth", c("1617", 1718", "1819")))
print(cutSeason(result_tbl, "Bournemouth", c("1718", "1819")))
print(cutSeason(result_tbl, "Crystal Palace", c("1718", "1819")))
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
source("code/cutSeason.R")
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
?labels
?factor
View(cutSeason)
source("code/cutSeason.R")
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
source("code/cutSeason.R")
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
?levels
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), length(years)))
levels(seasonSections) <- c("Start of Season", "Middle of Season", "End of Season")
5
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 5)
levels(seasonSections) <- c("Start of Season", "Middle of Season", "End of Season")
seasl
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 5)
levels(seasonSections) <- c("Start of Season", "Middle of Season", "End of Season")
seasonSections
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 5))
levels(seasonSections) <- c("Start of Season", "Middle of Season", "End of Season")
seasonSections
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
print(cutSeason(result_tbl, "Burnley", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Brighton", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Southampton", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Everton", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Man United", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Liverpool", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Liverpool", c("1718", "1819")))
print(cutSeason(result_tbl, "Man City", c("1718", "1819")))
print(cutSeason(result_tbl, "Man City", c("1617", "1718", "1819")))
# the 2018/2019 season and will be updated as the premier league seasons go on
load("data/result_tbl.R")
# b. team_list is a list object containing factor vectors which contain the teams for each Premier League
# season
load("data/team_list.R")
# c. goalSummary is a dataframe containing a summary of the overall goals scored and conceded by each team
# in the Premier league by season
load("data/goalSummary.R")
# What teams are common of the 2018/2019 / 2017/2018 / 2016/2017 seasons, hence weren't promoted or
# relegated during these seasons
goalSummary_1319 <- filter(goalSummary, Season %in% c("1314", "1415", "1516", "1617", "1718", "1819"))
teams_1319 <- intersect(team_list$teams_1819,
intersect(team_list$teams_1718,
intersect(team_list$teams_1617,
intersect(team_list$teams_1516,
intersect(team_list$teams_1415, team_list$teams_1314)))))
goalSummary_1319 <- filter(goalSummary_1319, Team %in% teams_1319)
library(dplyr)
goalSummary_1319 <- filter(goalSummary, Season %in% c("1314", "1415", "1516", "1617", "1718", "1819"))
teams_1319 <- intersect(team_list$teams_1819,
intersect(team_list$teams_1718,
intersect(team_list$teams_1617,
intersect(team_list$teams_1516,
intersect(team_list$teams_1415, team_list$teams_1314)))))
goalSummary_1319 <- filter(goalSummary_1319, Team %in% teams_1319)
?ggplot
library(ggplot2)
?ggplot
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
goalPlot_1319 <- g + geom_point(aes(color = HomeOrAway)) + facet_grid(Team ~ .) + geom_smooth(method = "lm")
print(goalPlot_1319)
goalSummary_1319
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
facet_grid(Team ~ .) + geom_smooth(method = "lm")
print(goalPlot_1319)
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
facet_grid(. ~ Team) + geom_smooth(method = "lm")
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(GoalAgainst, Season))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
facet_grid(. ~ Team) + geom_smooth(method = "lm")
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
goalPlot_1319 <- g + geom_point() +
facet_grid(. ~ Team) + geom_smooth(method = "lm")
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
facet_grid(. ~ Team) + geom_smooth(method = "lm")
print(goalPlot_1319)
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
facet_grid(. ~ Team) + geom_smooth()
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
geom_smooth(method = "lm") + facet_grid(. ~ Team)
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalScored))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
geom_smooth(method = "lm") + facet_grid(. ~ Team)
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalScored))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
geom_smooth(method = "lm")
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalScored))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
geom_smooth(method = "lm") + facet_grid(. ~ Team)
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm") + facet_grid(HomeorAway ~ Team)
print(goalPlot_1319)
str(goalPlot_1319)
str(goalSummary_1319)
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored))
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm") + facet_grid(HomeorAway ~ Team)
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
geom_smooth(method = "lm") + facet_grid(. ~ Team)
print(goalPlot_1319)
?geom_smooth
?ggplot
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored, color = HomeorAway))
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm", se = FALSE) + facet_grid(. ~ Team)
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored, color = HomeorAway))
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm", se = FALSE) + facet_grid(. ~ Team) +
labs(x = c("1819", "1718", "1617", "1516", "1415", "1314"))
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored, color = HomeorAway),
xlab = c("1819", "1718", "1617", "1516", "1415", "1314"))
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm", se = FALSE) + facet_grid(. ~ Team) +
print(goalPlot_1319)
rlang::last_error()
# the 2018/2019 season
load("data/result_tbl.R")
# b. team_list is a list object containing factor vectors which contain the teams for each Premier League
# season
load("data/team_list.R")
# c. goalSummary is a dataframe containing a summary of the overall goals scored and conceded by each team
# in the Premier league by season
load("data/goalSummary.R")
## Distribution of goals scored in the Premier League between 2009 to 2020
table(result_tbl$FTHG)
table(result_tbl$FTAG)
table(rbind(result_tbl$FTHG, result_tbl$FTAG))
# Plot histograms
par(mfrow = c(1, 3), mar = c(4, 4, 2, 1), oma = c(0,0,2,0))
hist(result_tbl$FTHG, col = "blue", xlab = "Home Goals", main = "Home Goals from 2009 to 2020")
hist(result_tbl$FTAG, col = "blue", xlab = "Away Goals", main = "Away Goals from 2009 to 2020")
hist(rbind(result_tbl$FTHG, result_tbl$FTAG), col = "green", xlab = "Total Goals", main = "Total Goals from 2009 to 2020")
mtext("Distribution of Goals Scored in the Premier League", outer = TRUE)
g <- ggplot(data = subset(result_tbl, HomeTeam == "Liverpool"), aes(FTHG))
g + geom_smooth()
library(ggplot2)
g <- ggplot(data = subset(result_tbl, HomeTeam == "Liverpool"), aes(FTHG))
g + geom_smooth()
qplot(FTHG, data = subset(result_tbl, HomeTeam == "Liverpool"), method = "density")
qplot(FTHG, data = subset(result_tbl, HomeTeam == "Liverpool"), method = "density", binwidth = 1)
qplot(FTHG, data = subset(result_tbl, HomeTeam == "Liverpool"))
qplot(FTHG, data = subset(result_tbl, HomeTeam == "Liverpool"), geom = c("density", "smooth"))
rlang::last_error()
head(result_tbl)
qplot(FTHG, data = subset(result_tbl, HomeTeam == "Liverpool", Season %in% c("1617", "1718", "1819")))
subset(result_tbl, HomeTeam == "Liverpool", Season %in% c("1617", "1718", "1819"))
library(dplyr)
qplot(FTHG, data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")))
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")),
binwidth = 0.75)
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")))
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")))
qplot(FTAG,
data = filter(subset(result_tbl, AwayTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")))
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")))
qplot(FTAG,
data = filter(subset(result_tbl, AwayTeam == "Man City"), Season %in% c("1617", "1718", "1819")))
library("jsonlite")
json_file <- 'https://datahub.io/sports-data/english-premier-league/datapackage.json'
json_data <- fromJSON(paste(readLines(json_file), collapse=""))
save(json_data, file = "data/datahub-premierleague-datapackage.json")
# get list of all resources:
print(json_data$resources$name)
source("code/extractSeason.R")
result_tbl <- rbind(
extractSeason(season = 32, year = "0910"),
extractSeason(season = 31, year = "1011"),
extractSeason(season = 30, year = "1112"),
extractSeason(season = 29, year = "1213"),
extractSeason(season = 28, year = "1314"),
extractSeason(season = 27, year = "1415"),
extractSeason(season = 26, year = "1516"),
extractSeason(season = 25, year = "1617"),
extractSeason(season = 24, year = "1718"),
extractSeason(season = 23, year = "1819")
)
result_tbl <- transform(result_tbl, Season = as.factor(Season))
head(result_tbl)
tail(result_tbl)
save(result_tbl, file = "data/result_tbl.R")
# a. result_tbl is a dataframe containing all of the resuts from the 2009/2010 premier league season to
# the 2018/2019 season
load("data/result_tbl.R")
# b. team_list is a list object containing factor vectors which contain the teams for each Premier League
# season
load("data/team_list.R")
# c. goalSummary is a dataframe containing a summary of the overall goals scored and conceded by each team
# in the Premier league by season
load("data/goalSummary.R")
# relegated during these seasons
library(dplyr)
goalSummary_1319 <- filter(goalSummary, Season %in% c("1314", "1415", "1516", "1617", "1718", "1819"))
teams_1319 <- intersect(team_list$teams_1819,
intersect(team_list$teams_1718,
intersect(team_list$teams_1617,
intersect(team_list$teams_1516,
intersect(team_list$teams_1415, team_list$teams_1314)))))
goalSummary_1319 <- filter(goalSummary_1319, Team %in% teams_1319)
# plot a linear model using lattice
library(lattice)
# look at a linear model of the goals scored home and away by each of the 14 teams that have stayed in the Premier League
# the last 3 seasons
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalScored ~ Season | Team * HomeorAway, pch = 19, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
# Goal conceded
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalAgainst ~ Season | Team * HomeorAway, pch = 19, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
goalSummary
team_list <- list(
"teams_0910" = sort(unique(extractSeason(season = 32, year = "0910")$HomeTeam)),
"teams_1011" = sort(unique(extractSeason(season = 31, year = "1011")$HomeTeam)),
"teams_1112" = sort(unique(extractSeason(season = 30, year = "1112")$HomeTeam)),
"teams_1213" = sort(unique(extractSeason(season = 29, year = "1213")$HomeTeam)),
"teams_1314" = sort(unique(extractSeason(season = 28, year = "1314")$HomeTeam)),
"teams_1415" = sort(unique(extractSeason(season = 27, year = "1415")$HomeTeam)),
"teams_1516" = sort(unique(extractSeason(season = 26, year = "1516")$HomeTeam)),
"teams_1617" = sort(unique(extractSeason(season = 25, year = "1617")$HomeTeam)),
"teams_1718" = sort(unique(extractSeason(season = 24, year = "1718")$HomeTeam)),
"teams_1819" = sort(unique(extractSeason(season = 23, year = "1819")$HomeTeam)),
)
team_list
team_list <- list(
"teams_0910" = sort(unique(extractSeason(season = 32, year = "0910")$HomeTeam)),
"teams_1011" = sort(unique(extractSeason(season = 31, year = "1011")$HomeTeam)),
"teams_1112" = sort(unique(extractSeason(season = 30, year = "1112")$HomeTeam)),
"teams_1213" = sort(unique(extractSeason(season = 29, year = "1213")$HomeTeam)),
"teams_1314" = sort(unique(extractSeason(season = 28, year = "1314")$HomeTeam)),
"teams_1415" = sort(unique(extractSeason(season = 27, year = "1415")$HomeTeam)),
"teams_1516" = sort(unique(extractSeason(season = 26, year = "1516")$HomeTeam)),
"teams_1617" = sort(unique(extractSeason(season = 25, year = "1617")$HomeTeam)),
"teams_1718" = sort(unique(extractSeason(season = 24, year = "1718")$HomeTeam)),
"teams_1819" = sort(unique(extractSeason(season = 23, year = "1819")$HomeTeam))
)
save(team_list, file = "data/team_list.R")
team_list
goalSummary <- rbind(
summary_df(season = filter(result_tbl, Season == "0910"), year = "0910"),
summary_df(season = filter(result_tbl, Season == "1011"), year = "1011"),
summary_df(season = filter(result_tbl, Season == "1112"), year = "1112"),
summary_df(season = filter(result_tbl, Season == "1213"), year = "1213"),
summary_df(season = filter(result_tbl, Season == "1314"), year = "1314"),
summary_df(season = filter(result_tbl, Season == "1415"), year = "1415"),
summary_df(season = filter(result_tbl, Season == "1516"), year = "1516"),
summary_df(season = filter(result_tbl, Season == "1617"), year = "1617"),
summary_df(season = filter(result_tbl, Season == "1718"), year = "1718"),
summary_df(season = filter(result_tbl, Season == "1819"), year = "1819")
)
source("code/summary_df.R")
## Note: this variation will much up the predict function which will need adapted to this new format
goalSummary <- rbind(
summary_df(season = filter(result_tbl, Season == "0910"), year = "0910"),
summary_df(season = filter(result_tbl, Season == "1011"), year = "1011"),
summary_df(season = filter(result_tbl, Season == "1112"), year = "1112"),
summary_df(season = filter(result_tbl, Season == "1213"), year = "1213"),
summary_df(season = filter(result_tbl, Season == "1314"), year = "1314"),
summary_df(season = filter(result_tbl, Season == "1415"), year = "1415"),
summary_df(season = filter(result_tbl, Season == "1516"), year = "1516"),
summary_df(season = filter(result_tbl, Season == "1617"), year = "1617"),
summary_df(season = filter(result_tbl, Season == "1718"), year = "1718"),
summary_df(season = filter(result_tbl, Season == "1819"), year = "1819")
)
goalSummary
save(goalSummary, file = "data/goalSummary.R")
# a. result_tbl is a dataframe containing all of the resuts from the 2009/2010 premier league season to
# the 2018/2019 season
load("data/result_tbl.R")
# b. team_list is a list object containing factor vectors which contain the teams for each Premier League
# season
load("data/team_list.R")
# c. goalSummary is a dataframe containing a summary of the overall goals scored and conceded by each team
# in the Premier league by season
load("data/goalSummary.R")
library(dplyr)
goalSummary_1319 <- filter(goalSummary, Season %in% c("1314", "1415", "1516", "1617", "1718", "1819"))
teams_1319 <- intersect(team_list$teams_1819,
intersect(team_list$teams_1718,
intersect(team_list$teams_1617,
intersect(team_list$teams_1516,
intersect(team_list$teams_1415, team_list$teams_1314)))))
goalSummary_1319 <- filter(goalSummary_1319, Team %in% teams_1319)
# plot a linear model using lattice
library(lattice)
# look at a linear model of the goals scored home and away by each of the 14 teams that have stayed in the Premier League
# the last 3 seasons
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalScored ~ Season | Team * HomeorAway, pch = 19, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
# Goal conceded
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalAgainst ~ Season | Team * HomeorAway, pch = 19, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
library(ggplot2)
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored, color = HomeorAway))
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm", se = FALSE) + facet_grid(. ~ Team) +
print(goalPlot_1319)
table(result_tbl$FTHG)
table(result_tbl$FTAG)
table(rbind(result_tbl$FTHG, result_tbl$FTAG))
# Plot histograms
par(mfrow = c(1, 3), mar = c(4, 4, 2, 1), oma = c(0,0,2,0))
hist(result_tbl$FTHG, col = "blue", xlab = "Home Goals", main = "Home Goals from 2009 to 2020")
hist(result_tbl$FTAG, col = "blue", xlab = "Away Goals", main = "Away Goals from 2009 to 2020")
hist(rbind(result_tbl$FTHG, result_tbl$FTAG), col = "green", xlab = "Total Goals", main = "Total Goals from 2009 to 2020")
mtext("Distribution of Goals Scored in the Premier League", outer = TRUE)
# ggplot implementation for individual teams
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")))
qplot(FTAG,
data = filter(subset(result_tbl, AwayTeam == "Man City"), Season %in% c("1617", "1718", "1819")))
source("code/distTeam.R")
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")),
title = "Distribution Home Goals")
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")),
main = "Distribution Home Goals")
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")),
main = "Distribution Home Goals", color = "blue")
data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")),
main = "Distribution Home Goals", fill = "blue")
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")),
main = "Distribution Home Goals")
?ggplot2::qplot
?ggplot
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTHG))
g + geom_histogram()
g + geom_histogram(fill = "blue") + title("Distribution of Home Goals")
g + geom_histogram(fill = "blue", alpha = .2) + title("Distribution of Home Goals")
g + geom_histogram(fill = "blue", alpha = .4, col = "red") + title("Distribution of Home Goals")
g + geom_histogram(fill = "blue", alpha = .4, col = "red") + labs(title = "Distribution of Home Goals")
g + geom_histogram(fill = "blue", alpha = .4, col = "red") + labs(title = "Man City Home Goal Distribution 2016 - 2019")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTHG))
g + geom_histogram(fill = "blue", alpha = .4, col = "red") + labs(title = "Man City Home Goal Distribution 2016 - 2019")
g <- ggplot(data = filter(subset(result_tbl, AwayTeam == "Man City"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTAG))
g + geom_histogram(fill = "blue", alpha = .4, col = "red") + labs(title = "Man City Away Goal Distribution 2016 - 2019")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "blue", alpha = .4, col = "red") + labs(title = "Man City Home Goal Distribution 2016 - 2019")
g <- ggplot(data = filter(subset(result_tbl, AwayTeam == "Man City"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTAG))
g + geom_bar(fill = "blue", alpha = .4, col = "red") + labs(title = "Man City Away Goal Distribution 2016 - 2019")
g + geom_bar(fill = "blue", alpha = .4, col = "red") + labs(title = "Man City Away Goal Distribution 2016 - 2019") + geom_smooth()
?geom_smooth
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "red", alpha = .4, col = "black") + labs(title = "Liverpool Home Goal Distribution 2016 - 2019")
g <- ggplot(data = filter(subset(result_tbl, AwayTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTAG))
g + geom_bar(fill = "red", alpha = .4, col = "black") + labs(title = "Liverpool Away Goal Distribution 2016 - 2019")
source("code/distTeam.R")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "red", alpha = .4, col = "black") + labs(title = "Liverpool Home Goal Distribution 2016 - 2019")
g <- ggplot(data = filter(subset(result_tbl, AwayTeam == "Liverpool"), Season %in% c("1718", "1819")),
mapping = aes(FTAG))
g + geom_bar(fill = "red", alpha = .4, col = "black") + labs(title = "Liverpool Away Goal Distribution 2016 - 2019")
source("code/distTeam.R")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "red", alpha = .8, col = "black") + labs(title = "Liverpool Home Goal Distribution 2016 - 2019")
g <- ggplot(data = filter(subset(result_tbl, AwayTeam == "Liverpool"), Season %in% c("1718", "1819")),
mapping = aes(FTAG))
g + geom_bar(fill = "red", alpha = .8, col = "black") + labs(title = "Liverpool Away Goal Distribution 2016 - 2019")
source("code/distTeam.R")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Bournemouth"), Season %in% c("1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "darksalmon", alpha = .8, col = "black") + labs(title = "Liverpool Home Goal Distribution 2016 - 2019")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Burnley"), Season %in% c("1516", "1617", "1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "darksalmon", alpha = .8, col = "black") + labs(title = "Liverpool Home Goal Distribution 2016 - 2019")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Burnley"), Season %in% c("1516", "1617", "1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "darkred", alpha = .8, col = "black") + labs(title = "Burnley Home Goal Distribution 2015 - 2019")
g <- ggplot(data = filter(subset(result_tbl, AwayTeam == "Liverpool"), Season %in% c("1516", "1617", "1718", "1819")),
mapping = aes(FTAG))
g + geom_bar(fill = "darkred", alpha = .8, col = "black") + labs(title = "Burnley Away Goal Distribution 2015 - 2019")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Burnley"), Season %in% c("1516", "1617", "1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "darkred", alpha = .8, col = "black") + labs(title = "Burnley Home Goal Distribution 2015 - 2019")
g <- ggplot(data = filter(subset(result_tbl, AwayTeam == "Burnley"), Season %in% c("1516", "1617", "1718", "1819")),
mapping = aes(FTAG))
g + geom_bar(fill = "darkred", alpha = .8, col = "black") + labs(title = "Burnley Away Goal Distribution 2015 - 2019")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Watford"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "yellow", alpha = .8, col = "black") + labs(title = "Watford Home Goal Distribution 2015 - 2019")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Watford"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "yellow", alpha = .8, col = "black") + labs(title = "Watford Home Goal Distribution 2015 - 2019")
g <- ggplot(data = filter(subset(result_tbl, AwayTeam == "Watford"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTAG))
g + geom_bar(fill = "darkred", alpha = .8, col = "black") + labs(title = "Watford Away Goal Distribution 2015 - 2019")
g <- ggplot(data = filter(subset(result_tbl, AwayTeam == "Watford"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTAG))
g + geom_bar(fill = "darkred", alpha = .8, col = "yellow") + labs(title = "Watford Away Goal Distribution 2015 - 2019")
g <- ggplot(data = filter(subset(result_tbl, HomeTeam == "Crystal Palace"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTHG))
g + geom_bar(fill = "red", alpha = .8, col = "blue") + labs(title = "Crystal Palace Home Goal Distribution 2015 - 2019")
g <- ggplot(data = filter(subset(result_tbl, AwayTeam == "Crystal Palace"), Season %in% c("1617", "1718", "1819")),
mapping = aes(FTAG))
g + geom_bar(fill = "red", alpha = .8, col = "blue") + labs(title = "Crystal Palace Away Goal Distribution 2015 - 2019")
source("code/distTeam.R")
