predict("Liverpool")
source("code/predict.R")
predict("Liverpool")
team_vector <- sapply(years, function(x) {paste0("team_", x)})
teams_1819 <- sort(unique(season_1819$HomeTeam))
teams_1718 <- sort(unique(season_1718$HomeTeam))
teams_1617 <- sort(unique(season_1617$HomeTeam))
predict("Liverpool")
head(season_1819)
head(homedata_1819)
intersect(teams_1819, intersect(teams_1718, teams_1617))
source("code/extractSeason.R")
source("seasondata.R")
teams_1819 <- sort(unique(season_1819$HomeTeam))
teams_1718 <- sort(unique(season_1718$HomeTeam))
teams_1617 <- sort(unique(season_1617$HomeTeam))
## vector of all season and team data frame names
years <- c("0910", "1011", "1112", "1213", "1314", "1415", "1516", "1617", "1718", "1819")
season_vector <- sapply(years, function(x) {paste0("season_", x)})
team_vector <- sapply(years, function(x) {paste0("team_", x)})
allSeason <- rbind(season_1819, season_1718, season_1617, season_1516, season_1415,
season_1314, season_1213, season_1112, season_1011, season_0910)
table(allSeason$FTHG)
table(allSeason$FTAG)
allGoal <- rbind(allSeason$FTHG, allSeason$FTAG)
table(allGoal)
# home and away dataframes 2018/2019
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal_1819 <- c(HomeGoals = sum(homedata_1819$GoalScored), AwayGoals = sum(homedata_1819$GoalAgainst))
# home and away dataframes 2017/2018
homedata1718 <- group_by(season1718, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata1718 <- group_by(season1718, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata1718 <- mutate(homedata1718, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata1718 <- mutate(awaydata1718, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1718 <- c(HomeGoals = sum(homedata1718$GoalScored), AwayGoals = sum(homedata1718$GoalAgainst))
# home and away dataframes 2016/2017
homedata1617 <- group_by(season1617, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata1617 <- group_by(season1617, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata1617 <- mutate(homedata1617, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata1617 <- mutate(awaydata1617, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1617 <- c(HomeGoals = sum(homedata1617$GoalScored), AwayGoals = sum(homedata1617$GoalAgainst))
library(dplyr)
# home and away dataframes 2017/2018
homedata_1718 <- group_by(season_1718, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1718 <- group_by(season_1718, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1718 <- mutate(homedata_1718, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1718 <- mutate(awaydata_1718, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1718 <- c(HomeGoals = sum(homedata_1718$GoalScored), AwayGoals = sum(homedata_1718$GoalAgainst))
homedata_1617 <- group_by(season_1617, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1617 <- group_by(season_1617, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1617 <- mutate(homedata_1617, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1617 <- mutate(awaydata_1617, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1617 <- c(HomeGoals = sum(homedata_1617$GoalScored), AwayGoals = sum(homedata_1617$GoalAgainst))
# use functions predict and actualResults to look at the effectiveness of the model
source("code/predict.R")
source("code/actualResults.R")
source("code/teamResult.R")
predict("Liverpool")
teamResult("Liverpool")
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal_1819 <- c(HomeGoals = sum(homedata_1819$GoalScored), AwayGoals = sum(homedata_1819$GoalAgainst))
source("code/predict.R")
source("code/teamResult.R")
predict("Liverpool")
teamResult("Liverpool")
totalGoal_1819
homedata_1819
homedata_1718[[which(homedata_1718$HomeTeam == "Liverpool"), "GoalScored"]]
source("seasondata.R")
teams_1819 <- sort(unique(season_1819$HomeTeam))
teams_1718 <- sort(unique(season_1718$HomeTeam))
teams_1617 <- sort(unique(season_1617$HomeTeam))
teams_1516 <- sort(unique(season_1516$HomeTeam))
years <- c("0910", "1011", "1112", "1213", "1314", "1415", "1516", "1617", "1718", "1819")
season_vector <- sapply(years, function(x) {paste0("season_", x)})
team_vector <- sapply(years, function(x) {paste0("team_", x)})
allSeason <- rbind(season_1819, season_1718, season_1617, season_1516, season_1415,
season_1314, season_1213, season_1112, season_1011, season_0910)
table(allSeason$FTHG)
table(allSeason$FTAG)
allGoal <- rbind(allSeason$FTHG, allSeason$FTAG)
table(allGoal)
library(dplyr)
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal_1819 <- c(HomeGoals = sum(homedata_1819$GoalScored), AwayGoals = sum(homedata_1819$GoalAgainst))
# home and away dataframes 2017/2018
homedata_1718 <- group_by(season_1718, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1718 <- group_by(season_1718, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1718 <- mutate(homedata_1718, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1718 <- mutate(awaydata_1718, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1718 <- c(HomeGoals = sum(homedata_1718$GoalScored), AwayGoals = sum(homedata_1718$GoalAgainst))
# home and away dataframes 2016/2017
homedata_1617 <- group_by(season_1617, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1617 <- group_by(season_1617, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1617 <- mutate(homedata_1617, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1617 <- mutate(awaydata_1617, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1617 <- c(HomeGoals = sum(homedata_1617$GoalScored), AwayGoals = sum(homedata_1617$GoalAgainst))
head(season_1819)
head(homedata_1819)
intersect(teams_1819, intersect(teams_1718, teams_1617))
homedata_1718[[which(homedata_1718$HomeTeam == "Chelsea"), "GoalScored"]]
str(season_1819)
recent_home <- sapply(c("1617", "1718", "1819"), function(x) {paste0("homedata_", x)})
recent_home
vector <- sapply(recent_home, function(x) {x[[which(x$HomeTeam == ":iverpool", "GoalScored")]]})
source("seasondata.R")
teams_1819 <- sort(unique(season_1819$HomeTeam))
teams_1718 <- sort(unique(season_1718$HomeTeam))
teams_1617 <- sort(unique(season_1617$HomeTeam))
## vector of all season and team data frame names
years <- c("0910", "1011", "1112", "1213", "1314", "1415", "1516", "1617", "1718", "1819")
season_vector <- sapply(years, function(x) {paste0("season_", x)})
team_vector <- sapply(years, function(x) {paste0("team_", x)})
## Distribution of goals scored in the Premier League between 2009 to 2020
allSeason <- rbind(season_1819, season_1718, season_1617, season_1516, season_1415,
season_1314, season_1213, season_1112, season_1011, season_0910)
table(allSeason$FTHG)
table(allSeason$FTAG)
allGoal <- rbind(allSeason$FTHG, allSeason$FTAG)
table(allGoal)
## 3. Home and Away data frames grouped by team
library(dplyr)
# home and away dataframes 2018/2019
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal_1819 <- c(HomeGoals = sum(homedata_1819$GoalScored), AwayGoals = sum(homedata_1819$GoalAgainst))
# home and away dataframes 2017/2018
homedata_1718 <- group_by(season_1718, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1718 <- group_by(season_1718, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1718 <- mutate(homedata_1718, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1718 <- mutate(awaydata_1718, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1718 <- c(HomeGoals = sum(homedata_1718$GoalScored), AwayGoals = sum(homedata_1718$GoalAgainst))
# home and away dataframes 2016/2017
homedata_1617 <- group_by(season_1617, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1617 <- group_by(season_1617, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1617 <- mutate(homedata_1617, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1617 <- mutate(awaydata_1617, GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1617 <- c(HomeGoals = sum(homedata_1617$GoalScored), AwayGoals = sum(homedata_1617$GoalAgainst))
homedata_1819 <- mutate(homedata_1819, Season = "1819", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
homedata_1819
homedata_1819 <- mutate(homedata_1819, Season = "1819", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
homedata_1819
# home and away dataframes 2018/2019
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, Season = "1819", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, Season = "1819", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal_1819 <- c(HomeGoals = sum(homedata_1819$GoalScored), AwayGoals = sum(homedata_1819$GoalAgainst))
# home and away dataframes 2017/2018
homedata_1718 <- group_by(season_1718, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1718 <- group_by(season_1718, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1718 <- mutate(homedata_1718, Season = "1718", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1718 <- mutate(awaydata_1718, Season = "1718", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1718 <- c(HomeGoals = sum(homedata_1718$GoalScored), AwayGoals = sum(homedata_1718$GoalAgainst))
# home and away dataframes 2016/2017
homedata_1617 <- group_by(season_1617, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1617 <- group_by(season_1617, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1617 <- mutate(homedata_1617, Season = "1617", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1617 <- mutate(awaydata_1617, Season = "1617", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1617 <- c(HomeGoals = sum(homedata_1617$GoalScored), AwayGoals = sum(homedata_1617$GoalAgainst))
rbind(homedata_1819, homedata_1718, homedata_1617, awaydata_1819, awaydata_1718, awaydata_1617)
homedata_1617
homedata_1718
homedata_1819
season_1619 <- rbind(homedata_1617, homedata_1718, homedata_1819)
season_1619 <- rbind(season_1619, awaydata_1617, awaydata_1718, awaydata_1819)
awaydata_1617
homedata_1619 <- rbind(homedata_1617, homedata_1718, homedata_1819)
homedata_1619 <- homedata_1619 %>% mutate(HomeorAway = as.factor(HomeorAway), Season = as.factor(Season))
homedata_1619
attach(homedata_1619)
goalPlot <- xyplot(GoalScored ~ Season | HomeTeam, panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
library(lattice)
goalPlot <- xyplot(GoalScored ~ Season | HomeTeam, panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
print(goalPlot)
teams_1619 <- intersect(teams_1819, intersect(teams_1718, teams_1617))
?subset
goalPlot <- xyplot(GoalScored ~ Season | subset(HomeTeam, HomeTeam == teams_1619), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
conssitant_season_1619 <- subset(season_1619, HomeTeam == teams_1619)
?filter
filter(season_1619, HomeTeam = teams_1619)
filter(season_1619, HomeTeam == teams_1619)
consistant_season_1619 <- filter(homedata_1619, HomeTeam == teams_1619)
teams_1619 <- as.factor(teams_1619)
teams_1619
season_1619 <- season_1619[[which(season_1619$HomeTeam == teams_1619), ]]
season_1619
season_1619_ <- season_1619 %>% filter(HomeTeam == teams_1619)
season_1619_ <- subset(season_1619, HomeTeam == teams_1619)
years <- c("0910", "1011", "1112", "1213", "1314", "1415", "1516", "1617", "1718", "1819")
team_vector <- sapply(years, function(x) {paste0("team_", x)})
team_vector <- sapply(years, function(x) {paste0("team_", x)})
team_vector
source("data/seasondata.R")
teams_1819 <- sort(unique(season_1819$HomeTeam))
teams_1718 <- sort(unique(season_1718$HomeTeam))
teams_1617 <- sort(unique(season_1617$HomeTeam))
teams_1516 <- sort(unique(season_1516$HomeTeam))
teams_1415 <- sort(unique(season_1415$HomeTeam))
teams_1314 <- sort(unique(season_1314$HomeTeam))
teams_1213 <- sort(unique(season_1213$HomeTeam))
teams_1112 <- sort(unique(season_1112$HomeTeam))
teams_1011 <- sort(unique(season_1011$HomeTeam))
teams_0910 <- sort(unique(season_0910$HomeTeam))
dump(list = list(teams_1819, teams_1718, teams_1617, teams_1516, teams_1415, teams_1314, teams_1213,
teams_1112, teams_1011, teams_0910), "data/teamdata.R")
?dump
team_list <- list(teams_1819, teams_1718, teams_1617, teams_1516, teams_1415, teams_1314, teams_1213,
teams_1112, teams_1011, teams_0910)
dump(list = team_list, file = "data/teamdata.R")
dump(team_list, file = "data/teamdata.R")
teams_1415
?droplevels
teams_1415 <- droplevels(teams_1415, "")
teams_1415
teams_1415 <- teams_1415[2:]
teams_1415 <- teams_1415[2:end]
teams_1415 <- teams_1415[2:21]
teams_1415
season_1415
tail(season_1415)
season_1415 <- season_1415[, 1:380]
season_1415 <- season_1415[1:380,]
tail(season_1415)
rm(list=ls())
# Source season data and create team vectors for each season
source("data/seasondata.R")
season_1415 <- season_1415[1:380,]
teams_1819 <- sort(unique(season_1819$HomeTeam))
teams_1718 <- sort(unique(season_1718$HomeTeam))
teams_1617 <- sort(unique(season_1617$HomeTeam))
teams_1516 <- sort(unique(season_1516$HomeTeam))
teams_1415 <- sort(unique(season_1415$HomeTeam))
teams_1314 <- sort(unique(season_1314$HomeTeam))
teams_1213 <- sort(unique(season_1213$HomeTeam))
teams_1112 <- sort(unique(season_1112$HomeTeam))
teams_1011 <- sort(unique(season_1011$HomeTeam))
teams_0910 <- sort(unique(season_0910$HomeTeam))
library(dplyr)
# home and away dataframes 2018/2019
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, Season = "1819", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, Season = "1819", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal_1819 <- c(HomeGoals = sum(homedata_1819$GoalScored), AwayGoals = sum(homedata_1819$GoalAgainst))
homedata_1819
season_1819
# Source season data and create team vectors for each season
source("data/seasondata.R")
season_1415 <- season_1415[1:380,]
teams_1819 <- sort(unique(season_1819$HomeTeam))
teams_1718 <- sort(unique(season_1718$HomeTeam))
teams_1617 <- sort(unique(season_1617$HomeTeam))
teams_1516 <- sort(unique(season_1516$HomeTeam))
teams_1415 <- sort(unique(season_1415$HomeTeam))
teams_1314 <- sort(unique(season_1314$HomeTeam))
teams_1213 <- sort(unique(season_1213$HomeTeam))
teams_1112 <- sort(unique(season_1112$HomeTeam))
teams_1011 <- sort(unique(season_1011$HomeTeam))
teams_0910 <- sort(unique(season_0910$HomeTeam))
## vector of all season and team data frame names
years <- c("0910", "1011", "1112", "1213", "1314", "1415", "1516", "1617", "1718", "1819")
season_vector <- sapply(years, function(x) {paste0("season_", x)})
team_vector <- sapply(years, function(x) {paste0("team_", x)})
## 3. Home and Away data frames grouped by team
library(dplyr)
# home and away dataframes 2018/2019
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, Season = "1819", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, Season = "1819", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal_1819 <- c(HomeGoals = sum(homedata_1819$GoalScored), AwayGoals = sum(homedata_1819$GoalAgainst))
# home and away dataframes 2017/2018
homedata_1718 <- group_by(season_1718, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1718 <- group_by(season_1718, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1718 <- mutate(homedata_1718, Season = "1718", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1718 <- mutate(awaydata_1718, Season = "1718", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1718 <- c(HomeGoals = sum(homedata_1718$GoalScored), AwayGoals = sum(homedata_1718$GoalAgainst))
# home and away dataframes 2016/2017
homedata_1617 <- group_by(season_1617, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1617 <- group_by(season_1617, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1617 <- mutate(homedata_1617, Season = "1617", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1617 <- mutate(awaydata_1617, Season = "1617", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1617 <- c(HomeGoals = sum(homedata_1617$GoalScored), AwayGoals = sum(homedata_1617$GoalAgainst))
teams_1619 <- intersect(teams_1819, intersect(teams_1718, teams_1617))
homedata_1819
homedata_1619 <- rbind(homedata_1819, homedata_1718, homedata_1617)
homedata_1619 <- filter(homedata_1619, HomeTeam %in% teams_1619)
homedata_1619
sum(unique(homedata_1619$HomeTeam))
attach(homedata_1619)
goalPlot <- xyplot(GoalScored ~ Season | HomeTeam, panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
print(goalPlot)
library(lattice)
goalPlot <- xyplot(GoalScored ~ Season | HomeTeam, panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
print(goalPlot)
homedata_1619 <- rbind(homedata_1819, homedata_1718, homedata_1617)
homedata_1619 <- transform(Season = as.factor(Season), HomeorAway = as.factor(HomeorAway))
homedata_1619 <- filter(homedata_1619, HomeTeam %in% teams_1619)
homedata_1619 <- rbind(homedata_1819, homedata_1718, homedata_1617)
homedata_1619 <- transform(data = homedata_1619,
Season = as.factor(Season), HomeorAway = as.factor(HomeorAway))
?transform
homedata_1619 <- transform(homedata_1619,
Season = as.factor(Season), HomeorAway = as.factor(HomeorAway))
homedata_1619 <- filter(homedata_1619, HomeTeam %in% teams_1619)
goalPlot <- xyplot(GoalScored ~ Season | HomeTeam, panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
attach(homedata_1619)
dettach(homedata_1619)
detach(homedata_1619)
attach(homedata_1619)
detach(homedata_1619)
detach(homedata_1619)
detach(homedata_1619)
attach(homedata_1619)
goalPlot <- xyplot(GoalScored ~ Season | HomeTeam, panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
print(goalPlot)
goalPlot <- xyplot(GoalScored ~ Season | HomeTeam, layout = c(14,1), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
print(goalPlot)
?merge
source("data/seasondata.R")
season_1415 <- season_1415[1:380,]
teams_1819 <- sort(unique(season_1819$HomeTeam))
teams_1718 <- sort(unique(season_1718$HomeTeam))
teams_1617 <- sort(unique(season_1617$HomeTeam))
teams_1516 <- sort(unique(season_1516$HomeTeam))
teams_1415 <- sort(unique(season_1415$HomeTeam))
teams_1314 <- sort(unique(season_1314$HomeTeam))
teams_1213 <- sort(unique(season_1213$HomeTeam))
teams_1112 <- sort(unique(season_1112$HomeTeam))
teams_1011 <- sort(unique(season_1011$HomeTeam))
teams_0910 <- sort(unique(season_0910$HomeTeam))
years <- c("0910", "1011", "1112", "1213", "1314", "1415", "1516", "1617", "1718", "1819")
season_vector <- sapply(years, function(x) {paste0("season_", x)})
team_vector <- sapply(years, function(x) {paste0("team_", x)})
allSeason <- rbind(season_1819, season_1718, season_1617, season_1516, season_1415,
season_1314, season_1213, season_1112, season_1011, season_0910)
library(dplyr)
# home and away dataframes 2018/2019
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, Season = "1819", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, Season = "1819", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal_1819 <- c(HomeGoals = sum(homedata_1819$GoalScored), AwayGoals = sum(homedata_1819$GoalAgainst))
# home and away dataframes 2017/2018
homedata_1718 <- group_by(season_1718, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1718 <- group_by(season_1718, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1718 <- mutate(homedata_1718, Season = "1718", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1718 <- mutate(awaydata_1718, Season = "1718", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1718 <- c(HomeGoals = sum(homedata_1718$GoalScored), AwayGoals = sum(homedata_1718$GoalAgainst))
# home and away dataframes 2016/2017
homedata_1617 <- group_by(season_1617, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1617 <- group_by(season_1617, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1617 <- mutate(homedata_1617, Season = "1617", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1617 <- mutate(awaydata_1617, Season = "1617", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
totalGoal1617 <- c(HomeGoals = sum(homedata_1617$GoalScored), AwayGoals = sum(homedata_1617$GoalAgainst))
homedata_1819
awaydata_1819
?join
?join.tbl_df
join(homedata_1819, awaydata_1819, by = c("HomeTeam" = "AwayTeam"))
library(dplyr)
join(homedata_1819, awaydata_1819, by = c("HomeTeam" = "AwayTeam"))
?merge
merge(homedata_1819, awaydata_1819, by.x = "HomeTeam", by.y = "AwayTeam")
merge(homedata_1819, awaydata_1819)
?rbind
names(homedata_1819$HomeTeam) == "Team"
names(homedata_1819$HomeTeam) <- "Team"
homedata_1819
attr(homedata_1819)
?attr
attributes(homedata_1819)
homedata_1819$names[["HomeTeam"]] <- "Team"
homedata_1819$names
homedata_1819
names(homedata_1819)
names(homedata_1819)[1]
names(homedata_1819)[1] <- "Team"
homedata_1819
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, Season = "1819", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, Season = "1819", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
names(homedata_1819)[1] <- "Team"; names(awaydata_1819)[1] <- "Team"; data_1819 <- cbind(homedata_1819, awaydata_1819)
totalGoal_1819 <- c(HomeGoals = sum(homedata_1819$GoalScored), AwayGoals = sum(homedata_1819$GoalAgainst))
data_1819
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, Season = "1819", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, Season = "1819", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
names(homedata_1819)[1] <- "Team"; names(awaydata_1819)[1] <- "Team"; data_1819 <- rbind(homedata_1819, awaydata_1819)
totalGoal_1819 <- c(HomeGoals = sum(homedata_1819$GoalScored), AwayGoals = sum(homedata_1819$GoalAgainst))
data_1819
allSeason
?rbind
library(dplyr)
# home and away dataframes 2018/2019
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, Season = "1819", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, Season = "1819", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
rbind(homedata_1617,awaydata_1617,make.row.names = TRUE)
summary_1819[10:30]
homedata_1819 <- group_by(season_1819, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
awaydata_1819 <- group_by(season_1819, AwayTeam) %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
homedata_1819 <- mutate(homedata_1819, Season = "1819", HomeorAway = "home", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
awaydata_1819 <- mutate(awaydata_1819, Season = "1819", HomeorAway = "away", GoalperGame = GoalScored / 19, ConcedeperGame = GoalAgainst / 19)
names(homedata_1819)[1] <- "Team"; names(awaydata_1819)[1] <- "Team"; summary_1819 <- rbind(homedata_1819, awaydata_1819)
summary_1819[10:30]
summary_1819[,10:30]
summary_1819[10:30,]
summary_1819[20:30,]
source("code/summary_df.R")
summary_1819 <- summary_df(season_1819, "1819")
summary_1819
source("code/summary_df.R")
summary_1819 <- summary_df(season_1819, "1819")
summary_1819
summary_1819
summary_1516
## Note: this variation will much up the predict function which will need adapted to this new format
summary_1819 <- summary_df(season = season_1819, year = "1819")
summary_1718 <- summary_df(season = season_1718, year = "1718")
summary_1617 <- summary_df(season = season_1617, year = "1617")
summary_1516 <- summary_df(season = season_1516, year = "1516")
summary_1415 <- summary_df(season = season_1415, year = "1415")
summary_1314 <- summary_df(season = season_1314, year = "1314")
summary_1213 <- summary_df(season = season_1213, year = "1213")
summary_1112 <- summary_df(season = season_1112, year = "1112")
summary_1011 <- summary_df(season = season_1011, year = "1011")
summary_0910 <- summary_df(season = season_0910, year = "0910")
summary_0910
summary_1516
source("code/summary_df.R")
summary_0910
## Note: this variation will much up the predict function which will need adapted to this new format
summary_1819 <- summary_df(season = season_1819, year = "1819")
summary_1718 <- summary_df(season = season_1718, year = "1718")
summary_1617 <- summary_df(season = season_1617, year = "1617")
summary_1516 <- summary_df(season = season_1516, year = "1516")
summary_1415 <- summary_df(season = season_1415, year = "1415")
summary_1314 <- summary_df(season = season_1314, year = "1314")
summary_1213 <- summary_df(season = season_1213, year = "1213")
summary_1112 <- summary_df(season = season_1112, year = "1112")
summary_1011 <- summary_df(season = season_1011, year = "1011")
summary_0910 <- summary_df(season = season_0910, year = "0910")
summary_0910
summary_1516
summary_1112
summary_1617
summary_data <- rbind(summary_1819, summary_1718, summary_1617, summary_1516, summary_1415,
summary_1314, summary_1213, summary_1112, summary_1011, summary_0910)
summary_data
tail(summary_data)
dump(summary_data, "data/summary-data.R")
dump(list(summary_data), "data/summary-data.R")
list <- list(summary_data)
list
source("data/seasondata.R")
season_1415 <- season_1415[1:380,]
source("code/summary_df.R")
## Note: this variation will much up the predict function which will need adapted to this new format
summary_data <- rbind(
summary_df(season = season_1819, year = "1819"),
summary_df(season = season_1718, year = "1718"),
summary_df(season = season_1617, year = "1617"),
summary_df(season = season_1516, year = "1516"),
summary_df(season = season_1415, year = "1415"),
summary_df(season = season_1314, year = "1314"),
summary_df(season = season_1213, year = "1213"),
summary_df(season = season_1112, year = "1112"),
summary_df(season = season_1011, year = "1011"),
summary_df(season = season_0910, year = "0910")
)
filter(summary_data, Season = "1516")
filter(summary_data, Season == "1516")
