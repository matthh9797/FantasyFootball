extractSeason(season = 25, year = "1617"),
extractSeason(season = 26, year = "1516"),
extractSeason(season = 27, year = "1415"),
extractSeason(season = 28, year = "1314"),
extractSeason(season = 29, year = "1213"),
extractSeason(season = 30, year = "1112"),
extractSeason(season = 31, year = "1011"),
extractSeason(season = 32, year = "0910")
)
result_tbl <- transform(result_df, Season = as.factor(Season))
result_tbl <- transform(result_tbl, Season = as.factor(Season))
result_tbl
View(result_tbl)
save(result_tbl, "data/result_tbl.R")
save(result_tbl, file = "data/result_tbl.R")
# create list of the teams in the Premier League by season
team_list <- list(
"teams_1819" = sort(unique(extractSeason(season = 23, year = "1819")$HomeTeam)),
"teams_1718" = sort(unique(extractSeason(season = 24, year = "1718")$HomeTeam)),
"teams_1617" = sort(unique(extractSeason(season = 25, year = "1617")$HomeTeam)),
"teams_1516" = sort(unique(extractSeason(season = 26, year = "1516")$HomeTeam)),
"teams_1415" = sort(unique(extractSeason(season = 27, year = "1415")$HomeTeam)),
"teams_1314" = sort(unique(extractSeason(season = 28, year = "1314")$HomeTeam)),
"teams_1213" = sort(unique(extractSeason(season = 29, year = "1213")$HomeTeam)),
"teams_1112" = sort(unique(extractSeason(season = 30, year = "1112")$HomeTeam)),
"teams_1011" = sort(unique(extractSeason(season = 31, year = "1011")$HomeTeam)),
"teams_0910" = sort(unique(extractSeason(season = 32, year = "0910")$HomeTeam))
)
save(team_list, file = "data/team_list.R")
source("code/summary_df.R")
summary_data <- rbind(
summary_df(season = season_1819, year = "1819"),
summary_df(season = season_1718, year = "1718"),
summary_df(season = season_1617, year = "1617"),
summary_df(season = season_1516, year = "1516"),
summary_df(season = season_1415, year = "1415"),
summary_df(season = season_1314, year = "1314"),
summary_df(season = season_1213, year = "1213"),
summary_df(season = season_1112, year = "1112"),
summary_df(season = season_1011, year = "1011"),
summary_df(season = season_0910, year = "0910")
)
summary_data <- rbind(
summary_df(season = filter(result_tbl, Season == "1819"), year = "1819"),
summary_df(season = filter(result_tbl, Season == "1718"), year = "1718"),
summary_df(season = filter(result_tbl, Season == "1617"), year = "1617"),
summary_df(season = filter(result_tbl, Season == "1516"), year = "1516"),
summary_df(season = filter(result_tbl, Season == "1415"), year = "1415"),
summary_df(season = filter(result_tbl, Season == "1314"), year = "1314"),
summary_df(season = filter(result_tbl, Season == "1213"), year = "1213"),
summary_df(season = filter(result_tbl, Season == "1112"), year = "1112"),
summary_df(season = filter(result_tbl, Season == "1011"), year = "1011"),
summary_df(season = filter(result_tbl, Season == "0910"), year = "0910")
)
summary_data
goalSummary <- rbind(
summary_df(season = filter(result_tbl, Season == "1819"), year = "1819"),
summary_df(season = filter(result_tbl, Season == "1718"), year = "1718"),
summary_df(season = filter(result_tbl, Season == "1617"), year = "1617"),
summary_df(season = filter(result_tbl, Season == "1516"), year = "1516"),
summary_df(season = filter(result_tbl, Season == "1415"), year = "1415"),
summary_df(season = filter(result_tbl, Season == "1314"), year = "1314"),
summary_df(season = filter(result_tbl, Season == "1213"), year = "1213"),
summary_df(season = filter(result_tbl, Season == "1112"), year = "1112"),
summary_df(season = filter(result_tbl, Season == "1011"), year = "1011"),
summary_df(season = filter(result_tbl, Season == "0910"), year = "0910")
)
goalSummary
tail(goalSummary)
save(goalSummary, file = "data/goalSummary.R")
save(json_data, file = "datahub-premierleague-datapackage.json")
save(json_data, file = "data/datahub-premierleague-datapackage.json")
?load
load("data/goalSummary.R")
load("data/result_tbl")
load("data/team_list")
load("data/goalSummary")
load("data/result_tbl.R")
load("data/team_list.R")
load("data/goalSummary.R")
goalSummary
library(dplyr)
goalSummary <- as.tbl(goalSummary)
goalSummary
table(result_tbl$FTHG)
par(mfrow = c(1, 3), mar = c(4, 4, 2, 1), oma = c(0,0,2,0))
hist(result_tbl$FTHG, col = "blue", xlab = "Home Goals", main = "Home Goals from 2009 to 2020")
hist(result_tbl$FTAG, col = "blue", xlab = "Away Goals", main = "Away Goals from 2009 to 2020")
hist(allGoal, col = "green", xlab = "Total Goals", main = "Total Goals from 2009 to 2020")
mtext("Distribution of Goals Scored in the Premier League", outer = TRUE)
# Plot histograms
par(mfrow = c(1, 3), mar = c(4, 4, 2, 1), oma = c(0,0,2,0))
hist(result_tbl$FTHG, col = "blue", xlab = "Home Goals", main = "Home Goals from 2009 to 2020")
hist(result_tbl$FTAG, col = "blue", xlab = "Away Goals", main = "Away Goals from 2009 to 2020")
hist(rbind(result_tbl$FTHG, result_tbl$FTAG), col = "green", xlab = "Total Goals", main = "Total Goals from 2009 to 2020")
mtext("Distribution of Goals Scored in the Premier League", outer = TRUE)
goalSummary_1619 <- filter(goalSummary, Season %in% c("1617", "1718", "1819"))
teams_1619 <- intersect(team_list$teams_1819,
intersect(team_list$teams_1718, team_list$teams_1617))
goalSummary_1619 <- filter(Team %in% teams_1619)
goalSummary_1619
tail(goalSummary_1619)
goalSummary_1619 <- filter(goalSummary_1619, Team %in% teams_1619)
goalSummary_1619
attach(goalSummary_1619)
goalPlot_1619 <- xyplot(GoalScored ~ Season | Team * HomeorAway, layout = c(14,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1619)
print(goalPlot_1619)
library(lattice)
attach(goalSummary_1619)
goalPlot_1619 <- xyplot(GoalScored ~ Season | Team * HomeorAway, layout = c(14,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1619)
print(goalPlot_1619)
attach(goalSummary_1619)
goalPlot_1619 <- xyplot(GoalConceded ~ Season | Team * HomeorAway, layout = c(14,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1619)
print(goalPlot_1619)
head(goalSummary_1619)
attach(goalSummary_1619)
goalPlot_1619 <- xyplot(GoalAgainst ~ Season | Team * HomeorAway, layout = c(14,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1619)
print(goalPlot_1619)
# the 2018/2019 season and will be updated as the premier league seasons go on
load("data/result_tbl.R")
# b. team_list is a list object containing factor vectors which contain the teams for each Premier League
# season
load("data/team_list.R")
# c. goalSummary is a dataframe containing a summary of the overall goals scored and conceded by each team
# in the Premier league by season
load("data/goalSummary.R")
# Plot histograms
par(mfrow = c(1, 3), mar = c(4, 4, 2, 1), oma = c(0,0,2,0))
hist(result_tbl$FTHG, col = "blue", xlab = "Home Goals", main = "Home Goals from 2009 to 2020")
hist(result_tbl$FTAG, col = "blue", xlab = "Away Goals", main = "Away Goals from 2009 to 2020")
hist(rbind(result_tbl$FTHG, result_tbl$FTAG), col = "green", xlab = "Total Goals", main = "Total Goals from 2009 to 2020")
mtext("Distribution of Goals Scored in the Premier League", outer = TRUE)
library(ggplot2)
qplot(result_tbl$FTHG)
qplot(result_tbl$FTHG, binwidth = 1)
table(result_tbl$FTHG)
# the 2018/2019 season and will be updated as the premier league seasons go on
load("data/result_tbl.R")
# b. team_list is a list object containing factor vectors which contain the teams for each Premier League
# season
load("data/team_list.R")
# c. goalSummary is a dataframe containing a summary of the overall goals scored and conceded by each team
# in the Premier league by season
load("data/goalSummary.R")
library(lattice)
goalSummary_1319 <- filter(goalSummary, Season %in% c("1314", "1415", "1516", "1617", "1718", "1819"))
library(dplyr)
goalSummary_1319 <- filter(goalSummary, Season %in% c("1314", "1415", "1516", "1617", "1718", "1819"))
teams_1319 <- intersect(team_list$teams_1819,
intersect(team_list$teams_1718,
intersect(team_list$teams_1617,
intersect(team_list$teams_1516,
intersect(team_list$teams_1415, team_list$teams_1314)))))
teams_1319
goalSummary_1319 <- filter(goalSummary_1619, Team %in% teams_1319)
goalSummary_1319 <- filter(goalSummary_1319, Team %in% teams_1319)
head(goalSummary_1319)
tail(goalSummary_1319)
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalScored ~ Season | Team * HomeorAway, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1619)
# the last 3 seasons
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalScored ~ Season | Team * HomeorAway, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalAgainst ~ Season | Team * HomeorAway, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
library(tidyverse)
library(tidyr)
?rev
rev(goalPlot_1319)
rev(goalSummary_1319)
goalSummary_1319[,order(ncol(goalPlot_1319:1))]
goalSummary_1319[,order(ncol(goalPlot_1319):1)]
goalSummary_1319
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalScored ~ rev(Season) | Team * HomeorAway, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalScored ~ Season | Team * HomeorAway, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalAgainst ~ Season | Team * HomeorAway, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalScored ~ Season | Team * HomeorAway, pch = 19, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
# Goal conceded
attach(goalSummary_1319)
goalPlot_1319 <- xyplot(GoalAgainst ~ Season | Team * HomeorAway, pch = 19, layout = c(10,2), panel = function(x, y, ...) {
panel.xyplot(x, y, ...)
panel.lmline(x, y, col = 2)
})
detach(goalSummary_1319)
print(goalPlot_1319)
result_tbl
str(result_tbl)
liverpoolResult1719 <- filter(result_tbl, (HomeTeam == "Liverpool" | AwayTeam == "Liverpool") & Season %in% c("1718", "1819"))
str(liverpoolResult1719)
?cut
?rep
rep(c(1,2,3), 4)
rbind(rep(1,13), rep(2,12), rep(3,13))
cbind(rep(1,13), rep(2,12), rep(3,13))
c(rep(1,13), rep(2,12), rep(3,13))
rep(c(rep(1,13), rep(2,12), rep(3,13)), 2)
seasonSections <- factor( rep(c(rep(1,13), rep(2,12), rep(3,13)), 2), labels = "Section 1", "Section 2", "Section 3")
seasonSections
?factor
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 2))
seasonSections
levels(seasonSections) <- c("Section 1", "Section 2", "Section 3")
seasonSections
liverpoolResult1719
liverpoolResult1719 <- mutate(liverpoolResult1719, Period = seasonSections)
liverpoolResult1719
?table
liveHome_1719 <- group_by(season, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
liveHome_1719 <- group_by(liverpoolResult1719, HomeTeam) %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
liveHome_1719
?dplyr::summarise
liveHome_1719 <- group_by(liverpoolResult1719, Period)
liveHome_1719
liveHome_1719 <- group_by(liverpoolResult1719, HomeTeam, Period) %>% summarise(GoalScored = sum(FTHG), GoalAgainst = sum(FTAG))
liveHome_1719
liveHome_1719 <- group_by(liverpoolResult1719, Period) %>% summarise(GoalScored = sum(FTHG), GoalAgainst = sum(FTAG))
liveHome_1719
liveHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Liverpool")
livAway_1719 <- filter(liverpoolResult1719, AwayTeam == "Liverpool")
liveHome_1719 <- liveHome_1719 %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
livAway_1719 <- livAway_1719 %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
liveHome_1719
livHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Liverpool") %>% group_by(Period)
livAway_1719 <- filter(liverpoolResult1719, AwayTeam == "Liverpool") %>% group_by(Period)
livHome_1719 <- livHome_1719 %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
livAway_1719 <- livAway_1719 %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
liveHome_1719
livHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Liverpool") %>% group_by(Period)
liveHome_1719
livHome_1719
livHome_1719 <- livHome_1719 %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
livHome_1719
livAway_1719
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 2))
levels(seasonSections) <- c("Section 1", "Section 2", "Section 3")
liverpoolResult1719 <- filter(result_tbl, (HomeTeam == "Liverpool" | AwayTeam == "Liverpool") & Season %in% c("1718", "1819"))
liverpoolResult1719 <- mutate(liverpoolResult1719, Period = seasonSections)
livHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Liverpool") %>% group_by(Period)
livAway_1719 <- filter(liverpoolResult1719, AwayTeam == "Liverpool") %>% group_by(Period)
livHome_1719 <- livHome_1719 %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
livAway_1719 <- livAway_1719 %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
livHome_1719
livAway_1719
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 2))
levels(seasonSections) <- c("Section 1", "Section 2", "Section 3")
liverpoolResult1719 <- filter(result_tbl, (HomeTeam == "Man City" | AwayTeam == "Man City") & Season %in% c("1718", "1819"))
liverpoolResult1719 <- mutate(liverpoolResult1719, Period = seasonSections)
manCHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Man City") %>% group_by(Period)
manCAway_1719 <- filter(liverpoolResult1719, AwayTeam == "Man City") %>% group_by(Period)
manCHome_1719 <- manCHome_1719 %>% summarise(GoalScored=sum(FTHG), GoalAgainst=sum(FTAG))
manCAway_1719 <- manCAway_1719 %>% summarise(GoalScored=sum(FTAG), GoalAgainst=sum(FTHG))
manCHome_1719
manCAway_1719
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 2))
levels(seasonSections) <- c("Section 1", "Section 2", "Section 3")
liverpoolResult1719 <- filter(result_tbl, (HomeTeam == "Man City" | AwayTeam == "Man City") & Season %in% c("1718", "1819"))
liverpoolResult1719 <- mutate(liverpoolResult1719, Period = seasonSections)
manCHome_1719 <- filter(liverpoolResult1719, HomeTeam == "Man City") %>% group_by(Period)
manCAway_1719 <- filter(liverpoolResult1719, AwayTeam == "Man City") %>% group_by(Period)
manCHome_1719 <- manCHome_1719 %>% summarise(HomeGoal=sum(FTHG), HomeConcede=sum(FTAG))
manCAway_1719 <- manCAway_1719 %>% summarise(AwayGoal=sum(FTAG), AwayConcede=sum(FTHG))
manC_cutSeason <- join(manCHome_1719, manCAway_1719)
manC_cutSeason <- merge(manCHome_1719, manCAway_1719)
manC_cutSeason
x <- c("a", "b", "c")
length(x)
source("data/cutSeason.R")
source("code/cutSeason.R")
cutSeason(result_tbl, "Man City", years = c("1718", "1819"))
city_1718 <- cutSeason(result_tbl, "Man City", years = c("1718", "1819"))
city_1718
print(cutSeason(result_tbl, "Chelsea", c("1718", "1819")))
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
source("code/cutSeason.R")
print(cutSeason(result_tbl, "Bournemouth", c("1718", "1819")))
print(cutSeason(result_tbl, "Bournemouth", c("1617", 1718", "1819")))
print(cutSeason(result_tbl, "Bournemouth", c("1718", "1819")))
print(cutSeason(result_tbl, "Crystal Palace", c("1718", "1819")))
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
source("code/cutSeason.R")
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
?labels
?factor
View(cutSeason)
source("code/cutSeason.R")
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
source("code/cutSeason.R")
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
?levels
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), length(years)))
levels(seasonSections) <- c("Start of Season", "Middle of Season", "End of Season")
5
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 5)
levels(seasonSections) <- c("Start of Season", "Middle of Season", "End of Season")
seasl
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 5)
levels(seasonSections) <- c("Start of Season", "Middle of Season", "End of Season")
seasonSections
seasonSections <- as.factor(rep(c(rep(1,13), rep(2,12), rep(3,13)), 5))
levels(seasonSections) <- c("Start of Season", "Middle of Season", "End of Season")
seasonSections
print(cutSeason(result_tbl, "Tottenham", c("1718", "1819")))
print(cutSeason(result_tbl, "Burnley", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Brighton", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Southampton", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Everton", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Man United", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Liverpool", c("1617", "1718", "1819")))
print(cutSeason(result_tbl, "Liverpool", c("1718", "1819")))
print(cutSeason(result_tbl, "Man City", c("1718", "1819")))
print(cutSeason(result_tbl, "Man City", c("1617", "1718", "1819")))
# the 2018/2019 season and will be updated as the premier league seasons go on
load("data/result_tbl.R")
# b. team_list is a list object containing factor vectors which contain the teams for each Premier League
# season
load("data/team_list.R")
# c. goalSummary is a dataframe containing a summary of the overall goals scored and conceded by each team
# in the Premier league by season
load("data/goalSummary.R")
# What teams are common of the 2018/2019 / 2017/2018 / 2016/2017 seasons, hence weren't promoted or
# relegated during these seasons
goalSummary_1319 <- filter(goalSummary, Season %in% c("1314", "1415", "1516", "1617", "1718", "1819"))
teams_1319 <- intersect(team_list$teams_1819,
intersect(team_list$teams_1718,
intersect(team_list$teams_1617,
intersect(team_list$teams_1516,
intersect(team_list$teams_1415, team_list$teams_1314)))))
goalSummary_1319 <- filter(goalSummary_1319, Team %in% teams_1319)
library(dplyr)
goalSummary_1319 <- filter(goalSummary, Season %in% c("1314", "1415", "1516", "1617", "1718", "1819"))
teams_1319 <- intersect(team_list$teams_1819,
intersect(team_list$teams_1718,
intersect(team_list$teams_1617,
intersect(team_list$teams_1516,
intersect(team_list$teams_1415, team_list$teams_1314)))))
goalSummary_1319 <- filter(goalSummary_1319, Team %in% teams_1319)
?ggplot
library(ggplot2)
?ggplot
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
goalPlot_1319 <- g + geom_point(aes(color = HomeOrAway)) + facet_grid(Team ~ .) + geom_smooth(method = "lm")
print(goalPlot_1319)
goalSummary_1319
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
facet_grid(Team ~ .) + geom_smooth(method = "lm")
print(goalPlot_1319)
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
facet_grid(. ~ Team) + geom_smooth(method = "lm")
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(GoalAgainst, Season))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
facet_grid(. ~ Team) + geom_smooth(method = "lm")
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
goalPlot_1319 <- g + geom_point() +
facet_grid(. ~ Team) + geom_smooth(method = "lm")
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
facet_grid(. ~ Team) + geom_smooth(method = "lm")
print(goalPlot_1319)
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
facet_grid(. ~ Team) + geom_smooth()
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalAgainst))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
geom_smooth(method = "lm") + facet_grid(. ~ Team)
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalScored))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
geom_smooth(method = "lm") + facet_grid(. ~ Team)
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalScored))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
geom_smooth(method = "lm")
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(Season, GoalScored))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
geom_smooth(method = "lm") + facet_grid(. ~ Team)
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm") + facet_grid(HomeorAway ~ Team)
print(goalPlot_1319)
str(goalPlot_1319)
str(goalSummary_1319)
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored))
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm") + facet_grid(HomeorAway ~ Team)
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored))
goalPlot_1319 <- g + geom_point(aes(color = HomeorAway)) +
geom_smooth(method = "lm") + facet_grid(. ~ Team)
print(goalPlot_1319)
?geom_smooth
?ggplot
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored, color = HomeorAway))
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm", se = FALSE) + facet_grid(. ~ Team)
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored, color = HomeorAway))
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm", se = FALSE) + facet_grid(. ~ Team) +
labs(x = c("1819", "1718", "1617", "1516", "1415", "1314"))
print(goalPlot_1319)
g <- ggplot(data = goalSummary_1319, aes(as.numeric(Season), GoalScored, color = HomeorAway),
xlab = c("1819", "1718", "1617", "1516", "1415", "1314"))
goalPlot_1319 <- g + geom_point() +
geom_smooth(method = "lm", se = FALSE) + facet_grid(. ~ Team) +
print(goalPlot_1319)
rlang::last_error()
# the 2018/2019 season
load("data/result_tbl.R")
# b. team_list is a list object containing factor vectors which contain the teams for each Premier League
# season
load("data/team_list.R")
# c. goalSummary is a dataframe containing a summary of the overall goals scored and conceded by each team
# in the Premier league by season
load("data/goalSummary.R")
## Distribution of goals scored in the Premier League between 2009 to 2020
table(result_tbl$FTHG)
table(result_tbl$FTAG)
table(rbind(result_tbl$FTHG, result_tbl$FTAG))
# Plot histograms
par(mfrow = c(1, 3), mar = c(4, 4, 2, 1), oma = c(0,0,2,0))
hist(result_tbl$FTHG, col = "blue", xlab = "Home Goals", main = "Home Goals from 2009 to 2020")
hist(result_tbl$FTAG, col = "blue", xlab = "Away Goals", main = "Away Goals from 2009 to 2020")
hist(rbind(result_tbl$FTHG, result_tbl$FTAG), col = "green", xlab = "Total Goals", main = "Total Goals from 2009 to 2020")
mtext("Distribution of Goals Scored in the Premier League", outer = TRUE)
g <- ggplot(data = subset(result_tbl, HomeTeam == "Liverpool"), aes(FTHG))
g + geom_smooth()
library(ggplot2)
g <- ggplot(data = subset(result_tbl, HomeTeam == "Liverpool"), aes(FTHG))
g + geom_smooth()
qplot(FTHG, data = subset(result_tbl, HomeTeam == "Liverpool"), method = "density")
qplot(FTHG, data = subset(result_tbl, HomeTeam == "Liverpool"), method = "density", binwidth = 1)
qplot(FTHG, data = subset(result_tbl, HomeTeam == "Liverpool"))
qplot(FTHG, data = subset(result_tbl, HomeTeam == "Liverpool"), geom = c("density", "smooth"))
rlang::last_error()
head(result_tbl)
qplot(FTHG, data = subset(result_tbl, HomeTeam == "Liverpool", Season %in% c("1617", "1718", "1819")))
subset(result_tbl, HomeTeam == "Liverpool", Season %in% c("1617", "1718", "1819"))
library(dplyr)
qplot(FTHG, data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")))
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")),
binwidth = 0.75)
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")))
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")))
qplot(FTAG,
data = filter(subset(result_tbl, AwayTeam == "Liverpool"), Season %in% c("1617", "1718", "1819")))
qplot(FTHG,
data = filter(subset(result_tbl, HomeTeam == "Man City"), Season %in% c("1617", "1718", "1819")))
qplot(FTAG,
data = filter(subset(result_tbl, AwayTeam == "Man City"), Season %in% c("1617", "1718", "1819")))
